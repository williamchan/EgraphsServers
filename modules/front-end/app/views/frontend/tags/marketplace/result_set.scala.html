@(availableOnly: Boolean = false,
  results: models.frontend.marketplace.ResultSetViewModel,
  requestStarForm: Form[models.frontend.marketplace.RequestStarViewModel],
  requestStarActionUrl: String
  )(
  implicit
  authToken: egraphs.authtoken.AuthenticityToken
)

@import views.html.frontend.tags.storefront_breadcrumbs_responsive
@import views.html.frontend.tags
@import models.frontend.forms.{Field, FormError}
@import views.frontend.Utils.bootstrapFields
@import egraphs.authtoken.AuthenticityToken.safeForm

<div class="verticals">
  <section class="clearfix" ng-cloak ng-controller="MarketplaceCtrl">
    <section>
      <div class="clearfix">
        <h1><span>{{results.subtitle}}</span></h1>
        <div class="available-only">
            <ol>
              <li>
              @if(!availableOnly){
                <a data-value="true">Hide Sold Out Stars</a>
              } else {
                <a data-value="false"> Show Sold Out Stars</a>
              }
              </li>
            </ol>
        </div>
      </div>

      @if(results.celebrities.size == 0) {
        <div class="request-star-option">
          <button id="request-star-button" type="button" class="button">
            <strong><em>Request a Star</em></strong>
            <span>&raquo;</span>
          </button>
        </div>

        <section class="span4">

          @safeForm(
            'id -> "request-star-form",
            'action -> requestStarActionUrl,
            'method -> "post",
            'class -> "login-option"
          ) {

            <div class="clearfix">
              <div class="request-star-fields" style="display: none">
                <fieldset>
                  <span id="star-name-field">
                    @helper.inputText(requestStarForm("starName"), '_label -> "Requested Star:", '_showConstraints -> false, '_tooltipOn -> true, '_tooltipText -> "Test tooltip")
                  </span>
                  <span id="email-field">
                    @helper.inputText(requestStarForm("email"), '_label -> "Email Address:", '_showConstraints -> false)
                  </span>
                </fieldset>
                @tags.arrow_button(caption="Submit", classes="button create-account")
              </div>
            </div>

          } <!-- end safe form -->

        </section>

      }

      <div class="clearfix">
        <article ng-repeat="celebrity in celebrities" when-scrolled="loadCelebrities()" class="celebrity-result">
          <figure>
              <a ng-show="celebrity.soldout" href="{{celebrity.storefrontUrl}}" class="ribbon"><em>Sold Out</em></a>
              <a class="glowborder" href="{{celebrity.storefrontUrl}}"><img ng-src={{celebrity.photoUrl}} alt="FPO image"></a>
          </figure>
          <hgroup>
            <p>
              <a href="{{celebrity.storefrontUrl}}">
                {{ celebrity | priceRange }}
              </a>
            </p>
            <h2><a href="{{celebrity.storefrontUrl}}" title="View star: {{celebrity.publicName}}">{{celebrity.publicName}}</a></h2>
            <h3>{{celebrity.secondaryText}}</h3>
          </hgroup>

        </article>
      </div>
      <p class="see-more" ng-show="total > 0">
        <em>
          <a class="clearfix" ng-click="loadCelebrities()"><b>Load More</b></a>
        </em>
      </p>
    </section>
  </section>
</div>