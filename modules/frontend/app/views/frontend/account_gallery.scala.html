@(username: String, egraphs: List[models.frontend.egraphs.EgraphViewModel], controlRenderer: models.frontend.egraphs.GalleryControlRenderer)(
implicit session: play.mvc.Scope.Session,
headerData: models.frontend.header.HeaderData,
footerData: models.frontend.footer.FooterData
)
@import views.frontend.Utils
@import models.frontend.egraphs._

@fulfilledEgraph(egraph: models.frontend.egraphs.FulfilledEgraphViewModel, index: Int) = {
  <div class="row-fluid row-egraph">
    <div class="span12">
      <div class="number">@(index+1)</div><br class="number-br">
      <span>
        <h3>@egraph.productPublicName.map(publicName => publicName + ":") @egraph.productTitle</h3>
      </span>
    </div>
    <div class="row-fluid">
      <div class="span7">
        <div class="@egraph.orientation">
          <img src="@egraph.thumbnailUrl" alt="Egraph preview"></img>
        </div>
      </div>
      <div class="span5 right">
        <div>
          @egraph.productUrl<br>
          Signed @egraph.signedTimestamp
        </div>
        <div>
          <p>@egraph.productDescription</p>
        </div>
        <div class="padding-fix">
          <div class="social">
            <ul class="clearfix">
              <li><span class="social-label">Share this</span></li>
              <li>
                <a href="@Utils.feedDialogLink(
                  appId = egraph.fbAppId,
                  picUrl = "http://fbrell.com/f8.jpg",
                  name= "Egraphs",
                  caption = "http://www.egraphs.com",
                  description= "An egraph is a personal interaction between " +
                                "a star and a fan: the fan writes to their " +
                                "favorite star, and the star sends back a 100% "  +
                                "personalized and authenticated handwritten note " +
                                "and audio message. The note is written on a beautiful " +
                                "photo backdrop to provide an ideal canvas for displaying and sharing. " +
                                "Egraphs are digital interactions, making it possible for stars to " +
                                "connect with fans anywhere in the world.",
                  redirectURI = egraph.redirectURI
                )" class="facebook">Facebook
                </a>
              </li>
              <li>
                <a href="@Utils.tweetButtonLink(
                  url= "http://www.egraphs.com/egraph/" + egraph.orderId,
                  text= "Check out my egraph from " + egraph.productPublicName.getOrElse("publicname") + "!"
                  )" target="_blank" class="twitter">Twitter
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="controls">
          @if(controlRenderer == OwnerGalleryControl){
            @views.frontend.tags.html.toggle(styleclass="private",
              name="privacy",
              id=egraph.orderId.toString,
              checked = (egraph.publicStatus == "Public"))
          }
          @Html(controlRenderer.render(egraph.orderId, egraph.publicStatus).toString())

        </div>
      </div>
    </div>
  </div>
}

@pendingEgraph(egraph: models.frontend.egraphs.PendingEgraphViewModel, orderDetails: models.frontend.egraphs.OrderDetails, index: Int) = {
  <div class="row-fluid row-egraph">
    <div class="span12">
      <div class="number">@(index+1)</div>
      <br class="number-br">
      <span>
        <h3>@egraph.productPublicName.map(publicName => publicName + ":") @egraph.productTitle</h3><span class="order-line"> &nbsp;Pending Order</span>
      </span>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
      <div class="pending-@egraph.orientation">
        <img src="@egraph.thumbnailUrl">
        </img>
      </div>
    </div>
    <div class="span6">
      <div class="order-row">
        <span class="order-label">Order Date</span><span class="order-detail"> @orderDetails.orderDate</span>
      </div>
      <div class="order-row">
        <span class="order-label">Order Number</span><span class="order-detail"> @orderDetails.orderNumber</span>
      </div>
    </div>
    <div class="span3 shipping-details">
      <span>Status: </span>@orderDetails.statusText<br>
      @{/*
        <span>Shipping: </span>@orderDetails.shippingMethod<br>
        <span>UPS Tracking Number: </span>@orderDetails.UPSNumber<br>
      */}
    </div>
  </div>
}
@baseBody = {
  <section id="content">
    <div id="main">
      <div class="container">
        <header id="gallerytop">
          <div class="row-fluid">
            <span class="span8 username">@username's Egraphs</span>
            <span class="span4 count">
              <strong>@egraphs.length Egraphs</strong> /
              <strong>@{egraphs.filter(egraph => egraph.isInstanceOf[models.frontend.egraphs.PendingEgraphViewModel]).length}</strong>
              Pending, <strong>@{egraphs.filter(egraph => egraph.isInstanceOf[models.frontend.egraphs.FulfilledEgraphViewModel]).length}</strong>
              Finished</span>
          </div>
        </header>
        @if(egraphs.length == 0) {
          <section>
            <h1>
              @username does not have any egraphs yet...
            </h1>
          </section>
        }
        <section id="galleryrows">
        @for((egraph,index) <- egraphs.zipWithIndex){
          @{egraph match {
            case e: models.frontend.egraphs.PendingEgraphViewModel => pendingEgraph(e, e.orderDetails, index)
            case e: models.frontend.egraphs.FulfilledEgraphViewModel => fulfilledEgraph(e, index)
            case _ => ""
            }
          }
        }
        </section>
      </div>
    </div>
  </section>
}

@base_template(
  title="Gallery",
  jsMain="pages/account-gallery",
  body=baseBody
)